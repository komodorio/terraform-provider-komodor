---
page_title: "komodor_policy_v2 Resource - terraform-provider-komodor"
subcategory: "RBAC & Policies"
description: |-
    Creates a Komodor RBAC Policy
---

# komodor_policy_v2 (Resource)

Creates a Komodor RBAC Policy

This resource allows you to define and manage **RBAC policies in Komodor**, specifying what actions are allowed and which clusters, namespaces, and workloads they apply to.

Each policy consists of one or more `statements`, which define:
- The `actions` that are allowed (see list of supported actions in komodor web app).
- The scope of resources the actions apply to, using fields like `clusters`, `namespaces`, `selectors`, or pattern-based filters.

This is useful for implementing fine-grained access control across environments.

## Example Usage

### Basic Policy

Defines a policy that allows read-only access to a known cluster and set of namespaces.

```terraform
resource "komodor_policy_v2" "simple_policy" {
  name = "simple-read-policy"
  type = "v2"

  statements {
    actions = ["view:all"]

    resources_scope {
      clusters   = ["prod-cluster"]
      namespaces = ["default", "kube-system"]
    }
  }
}
```

### Wildcard Cluster and/or Namespace

Targets resources in clusters and namespaces that match patterns (e.g., `team-*`), while excluding certain ones (e.g., `team-internal`).

```terraform
resource "komodor_policy_v2" "pattern_based_policy" {
  name = "pattern-read-policy"
  type = "v2"

  statements {
    actions = ["view:all"]

    resources_scope {
        clusters_patterns {
          include = "prod-*"
          exclude = "prod-legacy"
        }

        clusters_patterns {
          include = "staging-*"
          exclude = "staging-legacy"
        }
      

      namespaces_patterns {
          include = "team-*"
          exclude = "team-internal"
        }
    }
  }
}
```

### With Selectors

Uses label selectors to target specific workloads, e.g., resources labeled with `team=platform` and `env=production`.

```terraform
resource "komodor_policy_v2" "selector_based_policy" {
  name = "selector-read-policy"
  type = "v2"

  statements {
    actions = ["get", "list", "watch"]

    resources_scope {
      clusters   = ["prod-cluster"]
      namespaces = ["default"]

      selectors = [
        {
          key   = "team"
          type  = "annotation"
          value = "platform"
        },
        {
          key   = "env"
          type  = "label"
          value = "production"
        }
      ]
    }
  }
}
```

### With Selector Patterns

Matches resources by label keys using include/exclude value patterns.

```terraform
resource "komodor_policy_v2" "selector_pattern_policy" {
  name = "selector-pattern-policy"
  type = "v2"

  statements {
    actions = ["get", "list"]

    resources_scope {
      clusters   = ["prod-cluster"]
      namespaces = ["default"]

      selectors_patterns = [
        {
          key  = "team"
          type = "annotation"
          value = {
            include = "team-*"
            exclude = "team-internal"
          }
        }
      ]
    }
  }
}
```

## Argument Reference

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String)
- `statements` (Block List, Min: 1) (see [below for nested schema](#nestedblock--statements))

### Optional

- `type` (String)

### Read-Only

- `created_at` (String)
- `id` (String) The ID of this resource.
- `updated_at` (String)

<a id="nestedblock--statements"></a>
### Nested Schema for `statements`

Required:

- `actions` (List of String)
- `resources_scope` (Block List, Min: 1, Max: 1) (see [below for nested schema](#nestedblock--statements--resources_scope))

<a id="nestedblock--statements--resources_scope"></a>
### Nested Schema for `statements.resources_scope`

Optional:

- `clusters` (List of String)
- `clusters_patterns` (Block List) (see [below for nested schema](#nestedblock--statements--resources_scope--clusters_patterns))
- `namespaces` (List of String)
- `namespaces_patterns` (Block List) (see [below for nested schema](#nestedblock--statements--resources_scope--namespaces_patterns))
- `selectors` (Block List) (see [below for nested schema](#nestedblock--statements--resources_scope--selectors))
- `selectors_patterns` (Block List) (see [below for nested schema](#nestedblock--statements--resources_scope--selectors_patterns))

<a id="nestedblock--statements--resources_scope--clusters_patterns"></a>
### Nested Schema for `statements.resources_scope.clusters_patterns`

Required:

- `exclude` (String)
- `include` (String)


<a id="nestedblock--statements--resources_scope--namespaces_patterns"></a>
### Nested Schema for `statements.resources_scope.namespaces_patterns`

Required:

- `exclude` (String)
- `include` (String)


<a id="nestedblock--statements--resources_scope--selectors"></a>
### Nested Schema for `statements.resources_scope.selectors`

Required:

- `key` (String)
- `type` (String)
- `value` (String)


<a id="nestedblock--statements--resources_scope--selectors_patterns"></a>
### Nested Schema for `statements.resources_scope.selectors_patterns`

Required:

- `key` (String)
- `type` (String)

Optional:

- `value` (Block List, Max: 1) (see [below for nested schema](#nestedblock--statements--resources_scope--selectors_patterns--value))

<a id="nestedblock--statements--resources_scope--selectors_patterns--value"></a>
### Nested Schema for `statements.resources_scope.selectors_patterns.value`

Required:

- `exclude` (String)
- `include` (String)

## Import

This resource can be imported using the policy ID:

```sh
terraform import komodor_policy_v2.example <policy_id>
```

